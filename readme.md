This code contanins both the discharging logics in optimization_old,optimization 
and optimization1 codes.